## Описание фронта

**Мапинг полей и описание**

Форма предназначена для заполнения и отправки пользователем заявки на хранение груза на предварительно выбранном складе.

| Наименование поля на форме      | Поле в теле запроса | Описание                                                                                                           | Обязательно к заполнению | Значение по умолчанию |
|:--------------------------------|:--------------------|:-------------------------------------------------------------------------------------------------------------------|:------------------------:|:---------------------:|
| Наименование склада             | storage_uuid        | На форме отображается storage_title, полученный при открытии формы заявки. В теле запроса сохраняется storage_uuid |        Заполнено         |     storage_uuid      |
| Описание груза                  | cargo_description   | Многострочное текстовое поле с ограничением 800 символов                                                           |            Да            |                       |
| Общий объем - значение          | cargo_value         | Выводится в выбранных единицах измерения, передается в целых литрах. См. [Поле "Общий объём"](#Поле-Общий-объём)   |         Да, >=1          |                       |
| Общий объем - единица измерения | cargo_value_unit    | Предустановленный список значений. См. [Поле "Общий объём"](#Поле-Общий-объём)                                     |            Да            |    "м<sup>3</sup>"    |
| Общий вес                       | cargo_weight        | Общий вес. Указывается в тоннах, не более 3 знаков после запятой. Сохраняется и передается в целых киллограмах.    |         Да, >=1          |                       |
| Прикремпленные документы        | file_uuids          | Описание в разделе [Работа с файлами](#Работа-с-файлами)                                                           |           Нет            |                       |
| Срок хранения "с"               | from_storage_date   | Срок хранения "с". Сохраняется в формате даты.                                                                     |            Да            |     текущая дата      |
| Срок хранения "по"              | to_storage_date     | Срок хранения "по". Сохраняется в формате даты. Неактивно, если  is_timeless=TRUE                                  |           Нет            |                       |
| Признак "До востребования"      | is_timeless         | Признак "до востребования".                                                                                        |           Нет            |         False         |
| Сопроводительное письмо         | comment             | Многострочное текстовое поле с ограничением 1500 символов.                                                         |           Нет            |                       |
| Расширенная заявка              | is_extended         | Признак расширенной заявки. Переключатель задизейблен, значение  is_extended=false                                 |        Заполнено         |         False         |


## Работа с файлами

Работа с файлами происходит с использованием общего внутреннего сервиса common_files.  
При загрузке файла проверить его формат. Поддерживаются форматы:
* xls
* csv
* docx
* pdf

Если формат файла не соответсвует вышеперечисленным - вывести ошибку "Неправильный формат файла".

**Прикрепление файлов**
При загрузке файла пользователем выполняется метод "Сохранить файл".
   * Если получен ответ 200, то uuid файла сохраняется в массив file_uuids, а имя загруженного файла отображается в списке загруженных документов.
   * Если получена ошибка - uuid файла в массиве не сохраняется, текст ошибки выводится на экран.

**Открепление файлов**
Если в списке загруженных файлов пользователь нажал кнопку "Открепить", то:
  * Выполняется метод "Удалить файл" в сервисе common_files.
  * Независимо от ответа сервиса, uuid файла удаляется из массива file_uuids.

## Поле "Общий объём"

Поле отображается в указанных единицах. При сохранении передается в целых литрах. Перевод литров в отображаемую единицу происходит на фронте в соответсвии с указанным коэфициентом.

Дропдаун единц объема:

| Значение cargo_value_unit | Отображаемая единица | Описание         | Знаков после запятой | Коэфициент отображения |
|:--------------------------|:---------------------|:-----------------|:---------------------|:-----------------------|
| LITER                     | "Л"                  | Литры            | 3                    | 1000                   |
| METER3                    | "м<sup>3</sup>"      | Метры кубические | 0                    | 1                      |
| DAL                       | "Дал"                | Декалитры        | 1                    | 10                     |

Пример: "Пользователь указал 3,56 м<sup>3</sup>". В при сохранении значение полей должно быть:
``` json5
"cargo_value" : 3560,
"cargo_value_unit" : "Meter3"

```

## Кнопка "Отправить заявку"

**Проверка данных**  
Кнопка становится активной только если пройдены проверки:
1. Заполнены обязательные поля? указанные в таблице.
2. В "Срок хранения" заполнено поле "до" или стоит признак "до востребования"

**Действие кнопки**

При нажатии кнопки выполняется метод  `POST {server}/v1/order`
Поля заполняются в соответсвии с указанным выше мапингом.  
Пример тела запроса в опсиании метода: [Создание заявки]  
Если метод вернул ответ 201 - Вывести сообщение "Поздравляем, ваша заявка отправлена" и закрыть форму.  
Если метод вернул ошибку - вывести сообщение об ошибке на экран и оставить заполненную форму открытой.


[Создание заявки]: /TestExam/Постановка%20Back/readme.md#Создание-заявки
